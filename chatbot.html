
        closeChat.addEventListener('click', () => {
            chatbotWindow.classList.remove('active');
        });

        // Mensaje de bienvenida
        function showWelcomeMessage() {
            addBotMessage('Â¡Hola! ğŸ‘‹ Soy el asistente virtual de BridgeMindGames. Â¿En quÃ© puedo ayudarte hoy?');
            
            const optionsDiv = document.createElement('div');
            optionsDiv.className = 'options';
            optionsDiv.innerHTML = `
                <button class="option-button" onclick="askAbout('programa')">ğŸ“š Â¿QuÃ© es BridgeMindGames?</button>
                <button class="option-button" onclick="askAbout('idiomas')">ğŸŒ Â¿QuÃ© idiomas ofrecen?</button>
                <button class="option-button" onclick="askAbout('escuelas')">ğŸ« Programas para escuelas</button>
                <button class="option-button" onclick="askAbout('contacto')">ğŸ“ InformaciÃ³n de contacto</button>
            `;
            
            const lastMessage = chatMessages.lastElementChild;
            lastMessage.appendChild(optionsDiv);
        }

        // Agregar mensaje del bot
        function addBotMessage(text) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message bot';
            messageDiv.innerHTML = `<div class="message-content">${text}</div>`;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Agregar mensaje del usuario
        function addUserMessage(text) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message user';
            messageDiv.innerHTML = `<div class="message-content">${text}</div>`;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Procesar pregunta
        function processQuestion(question) {
            const lowerQuestion = question.toLowerCase();
            let response = null;

            // Buscar en la base de conocimiento
            for (const [key, value] of Object.entries(knowledgeBase)) {
                if (lowerQuestion.includes(key)) {
                    response = value;
                    break;
                }
            }

            if (response) {
                setTimeout(() => addBotMessage(response), 500);
            } else {
                // No sabe la respuesta - ofrecer WhatsApp
                setTimeout(() => {
                    addBotMessage('Lo siento, no tengo informaciÃ³n especÃ­fica sobre eso. ğŸ˜• Pero puedo conectarte con nuestro equipo para que te ayuden personalmente.');
                    
                    const messageDiv = document.createElement('div');
                    messageDiv.className = 'message bot';
                    messageDiv.innerHTML = `
                        <div class="message-content">
                            Â¿Te gustarÃ­a contactar directamente?
                            <a href="https://wa.me/34634268663?text=Hola,%20tengo%20una%20pregunta:%20${encodeURIComponent(question)}" 
                               class="whatsapp-button" target="_blank">
                                ğŸ’¬ Chatear por WhatsApp
                            </a>
                        </div>
                    `;
                    chatMessages.appendChild(messageDiv);
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                }, 500);
            }
        }

        // FunciÃ³n global para botones de opciones
        window.askAbout = function(topic) {
            addUserMessage(topic.charAt(0).toUpperCase() + topic.slice(1));
            processQuestion(topic);
        };

        // Enviar mensaje
        function sendMessage() {
            const question = chatInput.value.trim();
            if (question) {
                addUserMessage(question);
                chatInput.value = '';
                processQuestion(question);
            }
        }

        sendButton.addEventListener('click', sendMessage);
        chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
    </script>
</body>
</html>
